<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Por que n√£o faz sentido apanhar pra NodeJs</title>
</head>
<body>

<div id="albums">

</div>

<script>

    function getAlbumsPromise(method, url) {
        return new Promise(function (resolve, reject) {
            const tokenSpotify = 'BQAornj1UpDeQHVnbJ9TcPHiLd9QRK8ADcCTd1QRvDdkwnUT1Pb8XeMDKc_ZMatpmmLMLFdv3qeiV0zck0AghdFSgbTBjmOWa0SNQenOkCk-Ldrp5kReVq8lZ6-LnXtVXOCZJsNv8uZZhNqGmU_Iqg';
            const xhr = new XMLHttpRequest();

            xhr.onreadystatechange = function() {
                if (xhr.readyState == XMLHttpRequest.DONE ) {
                    if (xhr.status == 200) {
                        resolve(JSON.parse(xhr.responseText));
                    } else {

                        reject({
                          status: this.status,
                          statusText: xhr.statusText
                        });
                    }
                }
            };



            xhr.open('GET', url, true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.setRequestHeader("Authorization", 'Bearer ' + tokenSpotify);
            xhr.send()
        });
    }


    const albumsEl = document.getElementById('albums');

    getAlbumsPromise('GET', 'https://api.spotify.com/v1/search?q=Metallica&type=album')
        .then((data) => {
            const markup = data.albums.items.map(item =>
                `<img src="${item.images[0].url}" alt="item.name" />`
            ).join('');
            //console.log(markup);

            albumsEl.innerHTML = markup;


        })
        .catch((err) => {
          console.error('Augh, there was an error!', err);
        });




</script>
</body>
</html>
